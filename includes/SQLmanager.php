<?php//SQL manager  class SQLmanager    {        public $cid; //connection id        public $result; //query result        public $size_of_result = 0; //size of query result        public $last_id;        public $lquery;        public $host;        public $user;        public $pwd;        public $db; //current database        public function __construct($DBhost, $DBuser, $DBpwd, $DBname)        {            $this->host = $DBhost;            $this->user = $DBuser;            $this->pwd = $DBpwd;            $this->cid = mysql_connect($DBhost, $DBuser, $DBpwd) or $this->Error();            $this->db = $DBname;	    $this->Query("SET wait_timeout=7200");            $this->Query("SET interactive_timeout=7200");        }        public function reConnect()        {            $this->Close();            $this->cid = mysql_connect($this->host, $this->user, $this->pwd) or $this->Error();            $this->db = $DBname;	    $this->Query("SET wait_timeout=7200");            $this->Query("SET interactive_timeout=7200");        }        public function Error($query = '')        {            echo "<div style='font-family: verdana; font-size: 11px; color: #ff0000'><b>MySQL Error</b> " . mysql_errno() . ":".mysql_error()."<br /><font color='#000000'>".$query."</font></div>";        }        public function Query($query = '', $flag = 0)        {            if(!$this->cid){$this->reConnect();}        	$query = str_replace(array("\r","\n","\t"),'',$query);        	$query = preg_replace('/(,|\(){1}\s+/','$1',$query);            if (eregi('^select', $query))            {            	$this->lquery = $query;                $this->result = mysql_db_query($this->db, $query, $this->cid) or $this->Error($query);                $this->size_of_result = mysql_num_rows($this->result);                if ($flag == 1) return $this->size_of_result;                return $this->result;            }            else            {                mysql_db_query($this->db, $query, $this->cid) or $this->Error($query);                $this->size_of_result = mysql_affected_rows($this->cid);                if (eregi('^insert', $query)) $this->last_id = mysql_insert_id($this->cid);                return $this->size_of_result;            }        }        public function TableStatus()        {            if(!$this->cid){$this->reConnect();}        	mysql_select_db($this->db,$this->cid);        	$table_res = mysql_query ('show table status');        	return $table_res;		}        public function GetAssoc()        {            if(!$this->cid){$this->reConnect();}        	if($this->size_of_result != 0){        		while($row = mysql_fetch_assoc($this->result)){        			$data[] = $row;				}				return $data;			}else{				return false;			}		}        public function GetAssocFirst()        {            if(!$this->cid){$this->reConnect();}        	if($this->size_of_result != 0)			  {        	  return mysql_fetch_assoc($this->result);			  }			else{				return false;			}		}        public function GetFirst()        {            if(!$this->cid){$this->reConnect();}        	if($this->size_of_result != 0){                return mysql_result($this->result,0);			}else{				return false;			}		}        public function Close()        {            mysql_close($this->cid);        }    }?>